"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.EngineeringComponent = void 0;
const core_1 = require("@angular/core");
const THREE = require("three");
const OrbitControls_1 = require("three/examples/jsm/controls/OrbitControls");
// Class within a class
class Planet {
    constructor(radius, positionX, textureFile) {
        this.radius = radius;
        this.positionX = positionX;
        this.textureFile = textureFile;
    }
    buildMesh() {
        if (this.mesh == undefined || this.mesh == null) {
            const geometry = new THREE.SphereGeometry(this.radius);
            const texture = new THREE.TextureLoader().load(this.textureFile);
            const material = new THREE.MeshStandardMaterial({ map: texture });
            this.mesh = new THREE.Mesh(geometry, material);
            this.mesh.position.x += this.positionX;
        }
        return this.mesh;
    }
    createStar() {
        const geometry = new THREE.SphereGeometry(0.25, 24, 24);
        const material = new THREE.MeshStandardMaterial({ color: 0xffff66 });
        const star = new THREE.Mesh(geometry, material);
        const [x, y, z] = Array(3).fill(null).map(() => THREE.MathUtils.randFloatSpread(100));
        star.position.set(x, y, z);
        return star;
    }
}
let EngineeringComponent = class EngineeringComponent {
    constructor(renderer2) {
        this.renderer2 = renderer2;
        this.listener = this.renderer2.listen('window', 'scroll', (e) => {
            console.log(this.getYPosition(e));
        });
    }
    getYPosition(e) {
        return e.target.scrollTop;
    }
    ngOnDestroy() {
        this.listener();
    }
    ngOnInit() {
        const jdoc = document.getElementsByTagName("canvas")[0];
        const renderer = new THREE.WebGL1Renderer({
            canvas: jdoc,
            antialias: true
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        const orbit = new OrbitControls_1.OrbitControls(camera, renderer.domElement);
        camera.position.set(-40, -10, 50);
        orbit.update();
        const ambientLight = new THREE.AmbientLight(0x333333);
        scene.add(ambientLight);
        const spaceTexture = new THREE.TextureLoader().load("https://upload.wikimedia.org/wikipedia/commons/0/00/Center_of_the_Milky_Way_Galaxy_IV_%E2%80%93_Composite.jpg");
        scene.background = spaceTexture;
        const textureLoader = new THREE.TextureLoader();
        const sunGeo = new THREE.SphereGeometry(22);
        const sunMat = new THREE.MeshBasicMaterial({
            map: textureLoader.load("https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Map_of_the_full_sun.jpg/1600px-Map_of_the_full_sun.jpg")
        });
        const sunMesh = new THREE.Mesh(sunGeo, sunMat);
        scene.add(sunMesh);
        const pointLight = new THREE.PointLight(0xffffff, 2, 300);
        scene.add(pointLight);
        const mercury = new Planet(0.4, 28, "https://upload.wikimedia.org/wikipedia/commons/d/d3/Mercury_map_by_MESSENGER_global_mosaic_enhancedcolor_over_completebasemap.png");
        const mercMesh = mercury.buildMesh();
        const mercObj = new THREE.Object3D();
        mercObj.add(mercMesh);
        sunMesh.add(mercObj);
        const venus = new Planet(1.0, 44, "https://upload.wikimedia.org/wikipedia/commons/1/1c/Solarsystemscope_texture_8k_venus_surface.jpg");
        const venusMesh = venus.buildMesh();
        const venusObj = new THREE.Object3D();
        venusObj.add(venusMesh);
        sunMesh.add(venusObj);
        const earth = new Planet(1.2, 60, "https://upload.wikimedia.org/wikipedia/commons/c/cc/Earth_on_December_16%2C_2021.png");
        const earthMesh = earth.buildMesh();
        const earthObj = new THREE.Object3D();
        earthObj.add(earthMesh);
        sunMesh.add(earthObj);
        const mars = new Planet(1.1, 76, "https://upload.wikimedia.org/wikipedia/commons/8/8f/%28PSP_009353_1550_%29Late_Source_Region_for_Ladon_Valles.png");
        const marsMesh = mars.buildMesh();
        const marsObj = new THREE.Object3D();
        marsObj.add(marsMesh);
        sunMesh.add(marsObj);
        const jupiter = new Planet(9, 92, "https://static.wikia.nocookie.net/planet-texture-maps/images/c/c2/Dh_uranus_texture.png");
        const jupiterMesh = jupiter.buildMesh();
        const jupiterObj = new THREE.Object3D();
        jupiterObj.add(jupiterMesh);
        sunMesh.add(jupiterObj);
        const saturn = new Planet(7.5, 148, "https://static.wikia.nocookie.net/planet-texture-maps/images/f/fa/Saturn242.png");
        const saturnMesh = saturn.buildMesh();
        const saturnObj = new THREE.Object3D();
        saturnObj.add(saturnMesh);
        sunMesh.add(saturnObj);
        const neptune = new Planet(4.2, 154, "https://static.wikia.nocookie.net/planet-texture-maps/images/c/c1/Planetarium_neptune.jpg");
        const neptuneMesh = neptune.buildMesh();
        const neptuneObj = new THREE.Object3D();
        neptuneObj.add(neptuneMesh);
        sunMesh.add(neptuneObj);
        const uranus = new Planet(4.1, 170, "https://static.wikia.nocookie.net/planet-texture-maps/images/f/fa/Saturn242.png");
        const uranusMesh = uranus.buildMesh();
        const uranusObj = new THREE.Object3D();
        uranusObj.add(uranusMesh);
        sunMesh.add(uranusObj);
        const pluto = new Planet(1, 210, "https://static.wikia.nocookie.net/planet-texture-maps/images/6/64/Pluto_Made.png");
        const plutoMesh = pluto.buildMesh();
        const plutoObj = new THREE.Object3D();
        plutoObj.add(plutoMesh);
        sunMesh.add(plutoObj);
        const saturnRingGeo = new THREE.RingGeometry(10, 20, 32);
        const saturnRingMat = new THREE.MeshBasicMaterial({
            map: textureLoader.load("https://upload.wikimedia.org/wikipedia/commons/b/b1/Saturn%27s_rings_dark_side_mosaic.jpg"),
            side: THREE.DoubleSide
        });
        const saturnRing = new THREE.Mesh(saturnRingGeo, saturnRingMat);
        saturnObj.add(saturnRing);
        saturnRing.rotation.x = -0.25 * Math.PI;
        saturnRing.position.setX(148);
        sunMesh.add(saturnObj);
        const EARTH_YEAR = 2 * Math.PI * (1 / 60) * (1 / 60);
        const animate = () => {
            sunMesh.rotateY(0.004);
            mercObj.rotateY(0.018);
            venusObj.rotateY(EARTH_YEAR * -2);
            earthObj.rotateY(EARTH_YEAR);
            marsObj.rotateY(EARTH_YEAR * 0.5);
            jupiterObj.rotation.y += EARTH_YEAR * 0.8;
            saturnObj.rotation.y += EARTH_YEAR * 0.2;
            saturnRing.rotation.y += EARTH_YEAR * 0.01;
            neptuneObj.rotation.y += EARTH_YEAR * 2;
            uranusObj.rotation.y += EARTH_YEAR * 0.04;
            plutoObj.rotation.y += EARTH_YEAR * 0.05;
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        };
        animate();
    }
};
EngineeringComponent = __decorate([
    core_1.Component({
        selector: 'app-engineering',
        templateUrl: './engineering.component.html',
        styleUrls: ['./engineering.component.css']
    })
], EngineeringComponent);
exports.EngineeringComponent = EngineeringComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5naW5lZXJpbmcuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZW5naW5lZXJpbmcuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLHdDQUE2RDtBQUM3RCwrQkFBK0I7QUFDL0IsNkVBQTBFO0FBSTFFLHVCQUF1QjtBQUN2QixNQUFNLE1BQU07SUFNVixZQUFZLE1BQWMsRUFBRSxTQUFpQixFQUFFLFdBQW1CO1FBQ2hFLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxTQUFTO1FBQ1AsSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLFNBQVMsSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksRUFBRTtZQUMvQyxNQUFNLFFBQVEsR0FBRyxJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZELE1BQU0sT0FBTyxHQUFHLElBQUksS0FBSyxDQUFDLGFBQWEsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUE7WUFDaEUsTUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLENBQUMsb0JBQW9CLENBQUMsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQTtZQUNqRSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUE7WUFDOUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUM7U0FDeEM7UUFDRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDbkIsQ0FBQztJQUVELFVBQVU7UUFDUixNQUFNLFFBQVEsR0FBRyxJQUFJ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QUFJLFVBQVUsR0FBRyxHQUFHLENBQUM7WUFDekMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQztZQUMzQyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDO1lBQ3hDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLFVBQVUsR0FBRyxJQUFJLENBQUM7WUFDMUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQztZQUN6QyxxQkFBcUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUMvQixRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNqQyxDQUFDLENBQUM7UUFDRixPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7Q0FFRixDQUFBO0FBN0lZLG9CQUFvQjtJQUxoQyxnQkFBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLGlCQUFpQjtRQUMzQixXQUFXLEVBQUUsOEJBQThCO1FBQzNDLFNBQVMsRUFBRSxDQUFDLDZCQUE2QixDQUFDO0tBQzNDLENBQUM7R0FDVyxvQkFBb0IsQ0E2SWhDO0FBN0lZLG9EQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBSZW5kZXJlcjIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCAqIGFzIFRIUkVFIGZyb20gXCJ0aHJlZVwiO1xuaW1wb3J0IHsgT3JiaXRDb250cm9scyB9IGZyb20gXCJ0aHJlZS9leGFtcGxlcy9qc20vY29udHJvbHMvT3JiaXRDb250cm9sc1wiO1xuXG5pbXBvcnQgeyBHZW9tZXRyeSB9IGZyb20gXCJ0aHJlZS9leGFtcGxlcy9qc20vZGVwcmVjYXRlZC9HZW9tZXRyeVwiO1xuXG4vLyBDbGFzcyB3aXRoaW4gYSBjbGFzc1xuY2xhc3MgUGxhbmV0IHtcbiAgcmFkaXVzO1xuICBwb3NpdGlvblg7XG4gIHRleHR1cmVGaWxlO1xuICBtZXNoOiBUSFJFRS5NZXNoPFRIUkVFLlNwaGVyZUdlb21ldHJ5LCBUSFJFRS5NYXRlcmlhbD4gfCBudWxsIHwgdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKHJhZGl1czogbnVtYmVyLCBwb3NpdGlvblg6IG51bWJlciwgdGV4dHVyZUZpbGU6IHN0cmluZykge1xuICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgIHRoaXMucG9zaXRpb25YID0gcG9zaXRpb25YO1xuICAgIHRoaXMudGV4dHVyZUZpbGUgPSB0ZXh0dXJlRmlsZTtcbiAgfVxuXG4gIGJ1aWxkTWVzaCgpIHtcbiAgICBpZiAodGhpcy5tZXNoID09IHVuZGVmaW5lZCB8fCB0aGlzLm1lc2ggPT0gbnVsbCkge1xuICAgICAgY29uc3QgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkodGhpcy5yYWRpdXMpO1xuICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCkubG9hZCh0aGlzLnRleHR1cmVGaWxlKVxuICAgICAgY29uc3QgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFN0YW5kYXJkTWF0ZXJpYWwoeyBtYXA6IHRleHR1cmUgfSlcbiAgICAgIHRoaXMubWVzaCA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBtYXRlcmlhbClcbiAgICAgIHRoaXMubWVzaC5wb3NpdGlvbi54ICs9IHRoaXMucG9zaXRpb25YO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5tZXNoO1xuICB9XG5cbiAgY3JlYXRlU3Rhcigpe1xuICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDAuMjUsIDI0LCAyNClcbiAgICBjb25zdCBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoU3RhbmRhcmRNYXRlcmlhbCh7Y29sb3I6IDB4ZmZmZjY2fSlcbiAgICBjb25zdCBzdGFyID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICBjb25zdCBbeCwgeSwgel0gPSBBcnJheSgzKS5maWxsKG51bGwpLm1hcCgoKSA9PiBUSFJFRS5NYXRoVXRpbHMucmFuZEZsb2F0U3ByZWFkKDEwMCkpXG4gICAgc3Rhci5wb3NpdGlvbi5zZXQoeCwgeSwgeik7XG4gICAgcmV0dXJuIHN0YXI7XG4gIH1cbn1cblxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdhcHAtZW5naW5lZXJpbmcnLFxuICB0ZW1wbGF0ZVVybDogJy4vZW5naW5lZXJpbmcuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9lbmdpbmVlcmluZy5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgRW5naW5lZXJpbmdDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBsaXN0ZW5lcjtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZW5kZXJlcjI6IFJlbmRlcmVyMikge1xuICAgIHRoaXMubGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyMi5saXN0ZW4oJ3dpbmRvdycsICdzY3JvbGwnLCAoZSkgPT4ge1xuICAgICAgY29uc29sZS5sb2codGhpcy5nZXRZUG9zaXRpb24oZSkpO1xuICAgIH0pO1xuICB9XG5cblxuICBnZXRZUG9zaXRpb24oZTogRXZlbnQpOiBudW1iZXIge1xuICAgIHJldHVybiAoZS50YXJnZXQgYXMgRWxlbWVudCkuc2Nyb2xsVG9wO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lcigpO1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG5cbiAgICBjb25zdCBqZG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJjYW52YXNcIilbMF07XG5cbiAgICBjb25zdCByZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTDFSZW5kZXJlcih7XG4gICAgICBjYW52YXM6IGpkb2MsXG4gICAgICBhbnRpYWxpYXM6IHRydWVcbiAgICB9KTtcbiAgICByZW5kZXJlci5zZXRTaXplKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuXG5cbiAgICBjb25zdCBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuICAgIGNvbnN0IGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSg2MCwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMSwgMTAwMCk7XG4gICAgY29uc3Qgb3JiaXQgPSBuZXcgT3JiaXRDb250cm9scyhjYW1lcmEsIHJlbmRlcmVyLmRvbUVsZW1lbnQpXG4gICBcblxuICAgIGNhbWVyYS5wb3NpdGlvbi5zZXQoLTQwLCAtMTAsIDUwKTtcbiAgICBvcmJpdC51cGRhdGUoKTtcblxuICAgIGNvbnN0IGFtYmllbnRMaWdodCA9IG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoMHgzMzMzMzMpO1xuICAgIHNjZW5lLmFkZChhbWJpZW50TGlnaHQpO1xuXG5cbiAgICBjb25zdCBzcGFjZVRleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpLmxvYWQoXCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zLzAvMDAvQ2VudGVyX29mX3RoZV9NaWxreV9XYXlfR2FsYXh5X0lWXyVFMiU4MCU5M19Db21wb3NpdGUuanBnXCIpXG4gICAgc2NlbmUuYmFja2dyb3VuZCA9IHNwYWNlVGV4dHVyZVxuXG4gICAgY29uc3QgdGV4dHVyZUxvYWRlciA9IG5ldyBUSFJFRS5UZXh0dXJlTG9hZGVyKCk7XG5cbiAgICBjb25zdCBzdW5HZW8gPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkoMjIpO1xuICAgIGNvbnN0IHN1bk1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7XG4gICAgICBtYXA6IHRleHR1cmVMb2FkZXIubG9hZChcImh0dHBzOi8vdXBsb2FkLndpa2ltZWRpYS5vcmcvd2lraXBlZGlhL2NvbW1vbnMvdGh1bWIvOS85OS9NYXBfb2ZfdGhlX2Z1bGxfc3VuLmpwZy8xNjAwcHgtTWFwX29mX3RoZV9mdWxsX3N1bi5qcGdcIilcbiAgICB9KTtcbiAgICBjb25zdCBzdW5NZXNoID0gbmV3IFRIUkVFLk1lc2goc3VuR2VvLCBzdW5NYXQpO1xuICAgIHNjZW5lLmFkZChzdW5NZXNoKTtcbiAgICBjb25zdCBwb2ludExpZ2h0ID0gbmV3IFRIUkVFLlBvaW50TGlnaHQoMHhmZmZmZmYsIDIsIDMwMCk7XG4gICAgc2NlbmUuYWRkKHBvaW50TGlnaHQpO1xuXG4gICAgY29uc3QgbWVyY3VyeSA9IG5ldyBQbGFuZXQoMC40LCAyOCwgXCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zL2QvZDMvTWVyY3VyeV9tYXBfYnlfTUVTU0VOR0VSX2dsb2JhbF9tb3NhaWNfZW5oYW5jZWRjb2xvcl9vdmVyX2NvbXBsZXRlYmFzZW1hcC5wbmdcIik7XG4gICAgY29uc3QgbWVyY01lc2ggPSBtZXJjdXJ5LmJ1aWxkTWVzaCgpO1xuICAgIGNvbnN0IG1lcmNPYmogPSBuZXcgVEhSRUUuT2JqZWN0M0QoKVxuICAgIG1lcmNPYmouYWRkKG1lcmNNZXNoKTtcbiAgICBzdW5NZXNoLmFkZChtZXJjT2JqKVxuXG5cbiAgICBjb25zdCB2ZW51cyA9IG5ldyBQbGFuZXQoMS4wLCA0NCwgXCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zLzEvMWMvU29sYXJzeXN0ZW1zY29wZV90ZXh0dXJlXzhrX3ZlbnVzX3N1cmZhY2UuanBnXCIpO1xuICAgIGNvbnN0IHZlbnVzTWVzaCA9IHZlbnVzLmJ1aWxkTWVzaCgpO1xuICAgIGNvbnN0IHZlbnVzT2JqID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG4gICAgdmVudXNPYmouYWRkKHZlbnVzTWVzaCk7XG4gICAgc3VuTWVzaC5hZGQodmVudXNPYmopO1xuXG4gICAgY29uc3QgZWFydGggPSBuZXcgUGxhbmV0KDEuMiwgNjAsIFwiaHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy9jL2NjL0VhcnRoX29uX0RlY2VtYmVyXzE2JTJDXzIwMjEucG5nXCIpO1xuICAgIGNvbnN0IGVhcnRoTWVzaCA9IGVhcnRoLmJ1aWxkTWVzaCgpO1xuICAgIGNvbnN0IGVhcnRoT2JqID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG4gICAgZWFydGhPYmouYWRkKGVhcnRoTWVzaCk7XG4gICAgc3VuTWVzaC5hZGQoZWFydGhPYmopO1xuXG4gICAgY29uc3QgbWFycyA9IG5ldyBQbGFuZXQoMS4xLCA3NiwgXCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zLzgvOGYvJTI4UFNQXzAwOTM1M18xNTUwXyUyOUxhdGVfU291cmNlX1JlZ2lvbl9mb3JfTGFkb25fVmFsbGVzLnBuZ1wiKTtcbiAgICBjb25zdCBtYXJzTWVzaCA9IG1hcnMuYnVpbGRNZXNoKCk7XG4gICAgY29uc3QgbWFyc09iaiA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgIG1hcnNPYmouYWRkKG1hcnNNZXNoKTtcbiAgICBzdW5NZXNoLmFkZChtYXJzT2JqKTtcblxuICAgIGNvbnN0IGp1cGl0ZXIgPSBuZXcgUGxhbmV0KDksIDkyLCBcImh0dHBzOi8vc3RhdGljLndpa2lhLm5vY29va2llLm5ldC9wbGFuZXQtdGV4dHVyZS1tYXBzL2ltYWdlcy9jL2MyL0RoX3VyYW51c190ZXh0dXJlLnBuZ1wiKTtcbiAgICBjb25zdCBqdXBpdGVyTWVzaCA9IGp1cGl0ZXIuYnVpbGRNZXNoKCk7XG4gICAgY29uc3QganVwaXRlck9iaiA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgIGp1cGl0ZXJPYmouYWRkKGp1cGl0ZXJNZXNoKTtcbiAgICBzdW5NZXNoLmFkZChqdXBpdGVyT2JqKTtcblxuICAgIGNvbnN0IHNhdHVybiA9IG5ldyBQbGFuZXQoNy41LCAxNDgsIFwiaHR0cHM6Ly9zdGF0aWMud2lraWEubm9jb29raWUubmV0L3BsYW5ldC10ZXh0dXJlLW1hcHMvaW1hZ2VzL2YvZmEvU2F0dXJuMjQyLnBuZ1wiKTtcbiAgICBjb25zdCBzYXR1cm5NZXNoID0gc2F0dXJuLmJ1aWxkTWVzaCgpO1xuICAgIGNvbnN0IHNhdHVybk9iaiA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgIHNhdHVybk9iai5hZGQoc2F0dXJuTWVzaCk7XG4gICAgc3VuTWVzaC5hZGQoc2F0dXJuT2JqKTtcblxuICAgIGNvbnN0IG5lcHR1bmUgPSBuZXcgUGxhbmV0KDQuMiwgMTU0LCBcImh0dHBzOi8vc3RhdGljLndpa2lhLm5vY29va2llLm5ldC9wbGFuZXQtdGV4dHVyZS1tYXBzL2ltYWdlcy9jL2MxL1BsYW5ldGFyaXVtX25lcHR1bmUuanBnXCIpO1xuICAgIGNvbnN0IG5lcHR1bmVNZXNoID0gbmVwdHVuZS5idWlsZE1lc2goKTtcbiAgICBjb25zdCBuZXB0dW5lT2JqID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG4gICAgbmVwdHVuZU9iai5hZGQobmVwdHVuZU1lc2gpO1xuICAgIHN1bk1lc2guYWRkKG5lcHR1bmVPYmopO1xuXG4gICAgY29uc3QgdXJhbnVzID0gbmV3IFBsYW5ldCg0LjEsIDE3MCwgXCJodHRwczovL3N0YXRpYy53aWtpYS5ub2Nvb2tpZS5uZXQvcGxhbmV0LXRleHR1cmUtbWFwcy9pbWFnZXMvZi9mYS9TYXR1cm4yNDIucG5nXCIpO1xuICAgIGNvbnN0IHVyYW51c01lc2ggPSB1cmFudXMuYnVpbGRNZXNoKCk7XG4gICAgY29uc3QgdXJhbnVzT2JqID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG4gICAgdXJhbnVzT2JqLmFkZCh1cmFudXNNZXNoKTtcbiAgICBzdW5NZXNoLmFkZCh1cmFudXNPYmopO1xuXG4gICAgY29uc3QgcGx1dG8gPSBuZXcgUGxhbmV0KDEsIDIxMCwgXCJodHRwczovL3N0YXRpYy53aWtpYS5ub2Nvb2tpZS5uZXQvcGxhbmV0LXRleHR1cmUtbWFwcy9pbWFnZXMvNi82NC9QbHV0b19NYWRlLnBuZ1wiKTtcbiAgICBjb25zdCBwbHV0b01lc2ggPSBwbHV0by5idWlsZE1lc2goKTtcbiAgICBjb25zdCBwbHV0b09iaiA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgIHBsdXRvT2JqLmFkZChwbHV0b01lc2gpO1xuICAgIHN1bk1lc2guYWRkKHBsdXRvT2JqKTtcblxuICAgIGNvbnN0IHNhdHVyblJpbmdHZW8gPSBuZXcgVEhSRUUuUmluZ0dlb21ldHJ5KDEwLCAyMCwgMzIpO1xuICAgIGNvbnN0IHNhdHVyblJpbmdNYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xuICAgICAgbWFwOiB0ZXh0dXJlTG9hZGVyLmxvYWQoXCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zL2IvYjEvU2F0dXJuJTI3c19yaW5nc19kYXJrX3NpZGVfbW9zYWljLmpwZ1wiKSxcbiAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcbiAgICB9KVxuXG4gICAgY29uc3Qgc2F0dXJuUmluZyA9IG5ldyBUSFJFRS5NZXNoKHNhdHVyblJpbmdHZW8sIHNhdHVyblJpbmdNYXQpO1xuICAgIHNhdHVybk9iai5hZGQoc2F0dXJuUmluZyk7XG4gICAgc2F0dXJuUmluZy5yb3RhdGlvbi54ID0gLTAuMjUgKiBNYXRoLlBJO1xuICAgIHNhdHVyblJpbmcucG9zaXRpb24uc2V0WCgxNDgpO1xuICAgIHN1bk1lc2guYWRkKHNhdHVybk9iaik7XG5cblxuICAgIGNvbnN0IEVBUlRIX1lFQVIgPSAyICogTWF0aC5QSSAqICgxIC8gNjApICogKDEgLyA2MCk7XG4gICAgY29uc3QgYW5pbWF0ZSA9ICgpID0+IHtcbiAgICAgIHN1bk1lc2gucm90YXRlWSgwLjAwNCk7XG4gICAgICBtZXJjT2JqLnJvdGF0ZVkoMC4wMTgpXG4gICAgICB2ZW51c09iai5yb3RhdGVZKEVBUlRIX1lFQVIgKiAtMilcbiAgICAgIGVhcnRoT2JqLnJvdGF0ZVkoRUFSVEhfWUVBUilcbiAgICAgIG1hcnNPYmoucm90YXRlWShFQVJUSF9ZRUFSICogMC41KVxuICAgICAganVwaXRlck9iai5yb3RhdGlvbi55ICs9IEVBUlRIX1lFQVIgKiAwLjg7XG4gICAgICBzYXR1cm5PYmoucm90YXRpb24ueSArPSBFQVJUSF9ZRUFSICogMC4yO1xuICAgICAgc2F0dXJuUmluZy5yb3RhdGlvbi55ICs9IEVBUlRIX1lFQVIgKiAwLjAxO1xuICAgICAgbmVwdHVuZU9iai5yb3RhdGlvbi55ICs9IEVBUlRIX1lFQVIgKiAyO1xuICAgICAgdXJhbnVzT2JqLnJvdGF0aW9uLnkgKz0gRUFSVEhfWUVBUiAqIDAuMDQ7XG4gICAgICBwbHV0b09iai5yb3RhdGlvbi55ICs9IEVBUlRIX1lFQVIgKiAwLjA1O1xuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpO1xuICAgIH07XG4gICAgYW5pbWF0ZSgpO1xuICB9XG5cbn1cbiJdfQ==